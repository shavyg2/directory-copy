// Generated by CoffeeScript 1.7.1
(function() {
  var DirectoryCopy, fs, mkdirp, path;

  path = require("path");

  fs = require("fs");

  mkdirp = require("mkdirp");

  DirectoryCopy = (function() {
    function DirectoryCopy(input, output, verbose) {
      this.input = input;
      this.output = output;
      if (verbose == null) {
        verbose = false;
      }
      this.message = "";
      this.reader = require("node-dir");
      this.base = path.resolve(this.input);
      console.log("base is now " + this.base);
      debugger;
    }

    DirectoryCopy.prototype.getFiles = function() {
      debugger;
      var base, input, output, reader, writeFiles;
      reader = require("node-dir");
      base = this.base;
      input = this.input;
      output = this.output;
      writeFiles = function(input, output) {
        debugger;
        return fs.readFile(input, {
          encoding: "utf8"
        }, function(err, data) {
          if (err) {
            console.log("we have an error");
          } else {
            console.log("no error processing " + input + " to " + output);
          }
          if (typeof data === "undefined") {
            data = "";
          }
          console.log();
          return mkdirp(path.dirname(output), function() {
            return fs.writeFile(output, data, null, function() {
              return console.log("file saved, " + output);
            });
          });
        });
      };
      return reader.files(this.base, function(err, files) {
        debugger;
        var f, fp, _i, _len, _results;
        console.log("got the files and the length is " + files.length);
        _results = [];
        for (_i = 0, _len = files.length; _i < _len; _i++) {
          f = files[_i];
          console.log("processing " + f);
          fp = path.relative(input, f);
          console.log("the file is " + fp);
          input = path.resolve(base, f);
          output = path.resolve(process.cwd(), output, fp);
          console.log("we are moving from " + input + " to " + output);
          _results.push(writeFiles(input, output));
        }
        return _results;
      });
    };

    DirectoryCopy.prototype.log = function(text) {
      return this.message += "" + text + "\n";
    };

    return DirectoryCopy;

  })();

  exports.DirectoryCopy = DirectoryCopy;

}).call(this);
